<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.lawnroad.broadcast.chat.mapper.PreQuestionMapper">

    <resultMap id="PreQuestionResultMap" type="com.lawnroad.broadcast.chat.dto.PreQuestionDTO">
        <id     property="categoryNo"    column="category_no"/>
        <result property="name"          column="name"/>
        <result property="content"       column="content"/>
        <result property="thumbnailPath" column="thumbnail_path"/>
        <result property="date"          column="date"/>
        <result property="startTime"     column="start_time"/>
        <result property="endTime"       column="end_time"/>
        <result property="lawyerName"    column="lawyer_name"/>
        <collection property="keywords" ofType="string">
            <result column="keyword"/>
        </collection>
    </resultMap>

    <select id="findBySchedule" resultMap="PreQuestionResultMap">
        SELECT
        bs.category_no,
        bs.name,
        bs.content,
        bs.thumbnail_path,
        bs.date,
        bs.start_time,
        bs.end_time,
        l.name AS lawyer_name,
        k.keyword
        FROM broadcast_schedule bs
        JOIN `user` u ON bs.user_no = u.no
        JOIN lawyer l ON l.no = u.no
        LEFT JOIN keyword k ON k.schedule_no = bs.no
        WHERE bs.no = #{scheduleNo}
    </select>

</mapper>
